"use strict";!function(a){function b(b,c){this.$element=a(b),this.ratio=c}function c(){function c(c){a('[data-toggle="bt-ratio"]').each(function(){var c=a(this),d=c.data("bt-ratio"),e=parseFloat(c.attr("data-ratio"));return e?(d||c.data("bt-ratio",d=new b(this,e)),void d.resetHeight()):void console.error("data-ratio 系数未设置\n"+e)})}c(),a(window).resize(c)}b.prototype.resetHeight=function(){this.$element.css("height",this.$element.width()*this.ratio)},a.fn.Abox=c}(jQuery),function(a){function b(b){this.each(function(){var c=a(this),e=a(this).data("bt-circle-list");e||c.data("bt-circle-list",e=new d(this,b))})}var c={CIRCLE_TIME:1e3},d=function(b,d){this.options=c,this._setOptions(),this.$element=a(b),this.$list=this.$element.find(".bt-circle-list"),this.$element.css({height:this.$list.height()+"px"}),this.itemHeight=this.$list.height()/(this.$list.find(".item").length-this.$list.find(".item.hide").length),this.interval&&this.pause(),this._circle(),this.$element.on("mouseenter",function(a){this.interval&&this.pause()}.bind(this)),this.$element.on("mouseleave",function(a){this._circle()}.bind(this))};d.prototype._setOptions=function(b){this.options=a.extend({},this.options,b)},d.prototype._getCss=function(a,b){var c=a.css(b).match(/(\S+)px/);return c?parseFloat(c[1]):0},d.prototype._circle=function(){this.interval=!0;var a=this._getCss(this.$list,"top"),b=this.options.CIRCLE_TIME*(a+this.itemHeight)/this.itemHeight;this.$list.find(".item.hide").first().removeClass("hide");this.$list.animate({top:-this.itemHeight+"px"},b,"linear",function(){this.$list.find(".item").first().appendTo(this.$list).addClass("hide"),this.$list.css({top:0}),this._circle()}.bind(this))},d.prototype.pause=function(){this.interval=!1,this.$list.stop()},d.prototype.addItem=function(a){var b=document.createDocumentFragment(),c=null;a.forEach(function(a){c=document.createElement("li"),c.appendChild(document.createTextNode(a)),b.appendChild(c)}),this.$list[0].appendChild(b)},a.fn.CircleList=b}(jQuery),function(a){function b(b,c){this.$element=a(b),this.loadComponent(),this.initProperty(c),this.addEvent()}function c(c){return this.each(function(){var d=a(this),e=d.data("bt.imgClip");e?e.addEvent():d.data("bt.imgClip",e=new b(this,c))})}b.defaults={width:100,height:100,handle:!0,top:0,left:0},b.prototype.initProperty=function(c){this.setting=a.extend(!0,b.defaults,c?c:{}),this.$origin.attr("src",this.setting.img),a(".bt-imgclip-chosen-img").attr("src",this.setting.img),this.$mask.width(this.setting.width),this.$mask.height(this.setting.height),this.setPosition(this.setting.top,this.setting.left),this.width=this.$mask.width(),this.height=this.$mask.height(),this.top=this.$mask[0].offsetTop,this.left=this.$mask[0].offsetLeft},b.prototype.loadComponent=function(){var b='<div class="bt-imgclip-mask"><div class="bt-imgclip-chosen"><img class="bt-imgclip-chosen-img"><div class="bt-chosen-border top"></div><div class="bt-chosen-border bottom"></div><div class="bt-chosen-border left"></div><div class="bt-chosen-border right"></div></div><div class="bt-imgclip-handle"><div class="bt-handle-border top"></div><div class="bt-handle-border bottom"></div><div class="bt-handle-border left"></div><div class="bt-handle-border right"></div><div class="bt-handle-box top-center"></div><div class="bt-handle-box top-left"></div><div class="bt-handle-box top-right"></div><div class="bt-handle-box bottom-center"></div><div class="bt-handle-box bottom-left"></div><div class="bt-handle-box bottom-right"></div><div class="bt-handle-box left-middle"></div><div class="bt-handle-box right-middle"></div></div></div>',c='<img class="bt-imgclip-origin">';this.$mask=a(b),this.$origin=a(c),this.$chosenImg=a(".bt-imgclip-chosen-img",this.$mask),this.$element.append(this.$mask),this.$element.append(this.$origin)},b.prototype.addEvent=function(){this.$mask.on("mousedown",a.proxy(this.startMove,this))},b.prototype.startMove=function(b){b.stopPropagation(),b.preventDefault(),this.clientX=b.clientX,this.clientY=b.clientY;var c=this.getHandleType(b.target.classList.toString());a(document).on("mousemove",{type:c},a.proxy(this.handleMoving,this)),a(document).one("mouseup",{type:c},a.proxy(this.handleMoveEnd,this))},b.prototype.setPosition=function(a,b){this.$mask.css({top:a+"px",left:b+"px"}),this.$chosenImg.css({top:-a+"px",left:-b+"px"})},b.prototype.handleMoving=function(a){a.stopPropagation(),a.preventDefault();var b=a.clientX-this.clientX,c=a.clientY-this.clientY;switch(console.log("dX,dY:("+b+","+c+")"),a.data.type){case 0:this.changeChosenPosition(b,c);break;case 1:this.changeBoxSize("Y",c,-1);break;case 2:this.changeBoxSize("Y",c,1);break;case 3:this.changeBoxSize("X",b,-1);break;case 4:this.changeBoxSize("X",b,1)}},b.prototype.handleMoveEnd=function(b){this.width=this.$mask.width(),this.height=this.$mask.height(),this.top=this.$mask[0].offsetTop,this.left=this.$mask[0].offsetLeft,a(document).off("mousemove",a.proxy(this.handleMoving,this))},b.prototype.changeChosenPosition=function(a,b){var c=this.top||0,d=this.left||0;console.log("top,left:"+(c+b)+","+(d+a)),this.isMoveOut(a,b,!1)||0>c+b||0>d+a||this.setPosition(c+b,d+a)},b.prototype.changeBoxSize=function(a,b,c){if(console.log("width,height:("+this.width+","+this.height+")"),"X"==a){var d=b*this.height/this.width;if(this.isMoveOut(b*c,d*c,0>c))return;this.$mask.width(this.width+b*c),this.$mask.height(this.height+d*c),0>c&&this.changeChosenPosition(b,d)}else if("Y"==a){var e=b*this.width/this.height;if(this.isMoveOut(e*c,b*c,0>c))return;this.$mask.width(this.width+e*c),this.$mask.height(this.height+b*c),0>c&&this.changeChosenPosition(e,b)}},b.prototype.isMoveOut=function(a,b,c){var d=a+this.width+this.left,e=b+this.height+this.top;if(console.log("width,height:"+d+","+e),d>this.$chosenImg.width()||0>d||e>this.$chosenImg.height()||0>e)return!0;if(c){var f=this.top-b,g=this.left-a;if(console.log("top,left:"+f+","+g),0>f||0>g)return!0}return!1},b.prototype.getHandleType=function(a){return/bt-imgclip-chosen-img/.test(a)?(console.log("chosen 移动"),0):/bt-handle-(border|box)\stop/.test(a)?(console.log("border 上移"),1):/bt-handle-(border|box)\sbottom/.test(a)?(console.log("border 下移"),2):/bt-handle-(border|box)\sleft/.test(a)?(console.log("border 左移"),3):/bt-handle-(border|box)\sright/.test(a)?(console.log("border 右移"),4):void 0},a.fn.ImgClip=c}(jQuery),function(a,b){function c(a){this.$element=a,this._init()}function d(){var b;this.each(function(){var c=a(this);b=c.data("bt-layer")}),b?b.setTarget(this):this.data("bt-layer",b=new c(this))}c.prototype._init=function(){this._saveOriginPosition(),this._addEvent()},c.prototype._saveOriginPosition=function(){this.$element.each(function(){var b=a(this),c=b.data("data-layer-origin-position-y");c||b.data("data-layer-origin-position-y",parseFloat(b.css("background-position-y"),10))})},c.prototype._addEvent=function(){a(b).bind("load",this._scrollHandler.bind(this)),a(b).bind("scroll",this._scrollHandler.bind(this)),a(b).bind("resize",this._scrollHandler.bind(this))},c.prototype._scrollHandler=function(c){var d=a(b).scrollTop(),e=a(b).height();this.$element.each(function(b){var c=a(this),f=c.offset();if(f.top+c.height()>d&&d+e>f.top){var g=parseFloat(c.attr("data-layer-position-ratio"),10),h=c.data("data-layer-origin-position-y");c.css("background-position-y",h+(d+e-f.top)*g),console.log(b+":--->"+(h+(d+e-f.top)*g))}})},c.prototype.setTarget=function(a){this.$element=a,this._saveOriginPosition()},c.prototype.dispose=function(){this.$element.data("bt-layer",null),this.$element=null,a(b).unbind("load",this._scrollHandler.bind(this)),a(b).unbind("scroll",this._scrollHandler.bind(this)),a(b).unbind("resize",this._scrollHandler.bind(this))},a.fn.layer=d}(jQuery,window),function(a){function b(c,d){this.setting=a.extend(b.defaults,d),this.$element=a(c),this.addEvent()}function c(c){return this.each(function(){var d=a(this),e=d.data("limit-words");e?e.addEvent():d.data("limit-words",e=new b(this,c))})}b.defaults={limitLength:200},b.prototype.addEvent=function(){this.$element.on("keyup",a.proxy(this.chargeWordsNumber,this));var b=this;this.$element.one("focusout",function(){b.$element.off("keyup",a.proxy(b.chargeWordsNumber,b))})},b.prototype.chargeWordsNumber=function(a){for(var b=this.$element.val(),c=0,d=b.length,e=0;d>c;c++)if(e+=b.charCodeAt(c)>255?2:1,e>this.setting.limitLength)return e-=b.charCodeAt(c)>255?2:1,this.$element.next(".bt-input-add>.js-number").text(e),this.$element.val(b.slice(0,c));return this.$element.next(".bt-input-add").children(".js-number").text(e)},a.fn.LimitWords=c,a(document).ready(function(){a(document).on("click",'[data-toggle="limit-words"]',function(b){var d=a(b.target),e=parseInt(d.attr("data-limit"));c.call(d,{limitLength:e})})})}(jQuery),function(a){function b(b,d){return this.each(function(){var e=a(this),f=e.data("bt.modal");f||e.data("bt.modal",f=new c(this,b)),"string"==typeof b?f[b](d):b.show&&f.show(d)})}var c=function(b,c){this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".bt-modal-dialog"),this.$backdrop=null,this.isShown=null};c.TRANSITION_DURATION=300,c.defualts={},c.prototype.show=function(b){var c=a.Event("show.bt.modal",{relatedTarget:b});if(this.$element.trigger(c),!this.isShown){this.isShown=!0;var d=this.measureScrollbar();this.$body.addClass("bt-modal-open"),this.hideScrollbar(d),this.backdrop(function(){})}},c.prototype.hide=function(a){this.$element.removeClass("in").off(".dismiss.bt.modal"),this.$backdrop.removeClass("in").off("dismiss.bt.modal"),this.isShown=!1,this.$element.hide(),this.$body.removeClass("bt-modal-open"),this.resetScrollbar(),this.removeBackdrop()},c.prototype.toggle=function(a){this.isShown?this.hide(a):this.show(a)},c.prototype.backdrop=function(b){var c=this;this.isShown&&(this.$backdrop=a(document.createElement("div")),this.$backdrop.addClass("bt-modal-backdrop fade").appendTo(this.$body),this.$element.on("click.dismiss.bt.modal",function(b){a(b.target).is(c.$element[0])&&c.hide()}),this.$backdrop.on("click",function(a){c.hide()}),this.$backdrop.addClass("in"),this.$element.show(0).addClass("in"))},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.hideScrollbar=function(a){this.originBodyPaddingRight=parseInt(this.$body.css("padding-right")||0,10),this.$body.css("padding-right",this.originBodyPaddingRight+a)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originBodyPaddingRight)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="bt-modal-measure-scrollbar",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b},a.fn.modal=b,a(document.body).on("click.bt.modal.auto-init",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bt.modal")?"toggle":a.extend({show:!0},f.data(),d.data());d.is("a")&&c.preventDefault(),b.call(f,g,this)})}(jQuery),function(a){function b(b){this.each(function(){var c=a(this),e=a(this).data("bt-roll-list");e||c.data("bt-roll-list",e=new d(this,b))})}var c={ROLL_TIME:600},d=function(b,d){this.options=c,this._setOptions(d),this.$element=a(b),this.$list=a(".bt-roll-list",this.$element),this.$items=a(".item.active",this.$list),this.$element.css({height:this.$list.height()+"px"}),this.hideNumber=this.$list.find(".item").length-this.$items.length,this.interval&&clearInterval(this.interval),this.interval=setInterval(this._roll.bind(this),this.options.ROLL_TIME)};d.prototype._roll=function(){if(0>=this.hideNumber)return clearInterval(this.interval),void(this.interval=null);var b=(this.$list.find(".item.active"),a(this.$list.find(".item")[--this.hideNumber]));b.slideDown("slow",function(){b.addClass("active"),this.$list.find(".item.active").last().remove()}.bind(this))},d.prototype.addItem=function(b){var c,d=document.createDocumentFragment(),e=a(d);b.forEach(function(a){c=document.createElement("li"),c.appendChild(document.createTextNode(a)),c.className="item",e.prepend(c)}),this.$list.prepend(d),this.hideNumber+=b.length,this.interval||this.hideNumber>0&&(this._roll(),this.interval=setInterval(this._roll.bind(this),this.options.ROLL_TIME))},d.prototype._setOptions=function(b){this.options=a.extend({},this.options,b)},a.fn.RollList=b}(jQuery),function(a){function b(b){this.each(function(){var d=a(this),e=d.data("bt.slider");e||d.data("bt.slider",e=new c(this,b))})}var c=function(b,d){this.options=a.extend({},c.defaults,d),this.$element=a(b),this.$content=a(".bt-slider-content",this.$element),this.$items=a(".bt-slider-item",this.$content),this.$navs=a(".bt-slider-nav",this.$element).children(),this.index=0,this.len=this.$items.length,this.sliding=!1,this.interval=this.autoPlay();var e=window.navigator.userAgent.match(/MSIE\s(\d)/);e&&(this.isIE=!0,this.ieV=e[1]),this.isIE&&this.ieV<9&&(this.$navs.css({"background-color":"white"}),console.log("yes")),this.$navs.on("click",function(b){this.$items.finish();var c=a(b.target).data("slide-to");return c<this.index?this.slide("prev",a(this.$items.get(c))):c>this.index?this.slide("next",a(this.$items.get(c))):void 0}.bind(this)),this.$element.on("mouseenter",function(a){this.interval&&clearInterval(this.interval)}.bind(this)),this.$element.on("mouseleave",function(a){this.interval=this.autoPlay()}.bind(this))};c.defaults={interval:3e3},c.prototype.autoPlay=function(){return this.interval&&clearInterval(this.interval),setInterval(this.next.bind(this),this.options.interval)},c.prototype.next=function(){return this.sliding?void 0:this.slide("next")},c.prototype.right=function(){return this.sliding?void 0:this.slide("prev")},c.prototype.slide=function(b,c){var d=a(".bt-slider-item.active",this.$content),e=null,f="next"==b?"left":"right";return e=c||this.getNextNode(b,d),e.length?(this.sliding=!0,e.addClass(b),e[0].offsetWidth,d.addClass(f),e.addClass(f),void this._switchActiveState(d,e,b,f)):void console.error("slider 获取下一页内容失败！")},c.prototype._switchActiveState=function(b,c,d,e){if(!this.isIE||this.ieV>=9)var f=0,g=setInterval(function(){f++,b.is(":animated")||f%2!=0||(clearInterval(g),b.removeClass(["active",e].join(" ")),c.removeClass([d,e].join(" ")).addClass("active"),this.index=this.getNodeIndex(c),this.$navs.removeClass("active"),a(this.$navs.get(this.index)).addClass("active"),this.sliding=!1)}.bind(this),300);else b.removeClass(["active",e].join(" ")),c.removeClass([d,e].join(" ")).addClass("active"),this.index=this.getNodeIndex(c),this.$navs.removeClass("active"),a(this.$navs.get(this.index)).addClass("active"),this.sliding=!1},c.prototype.getNodeIndex=function(a){return this.$items=a.parent().children(".bt-slider-item"),this.$items.index(a)},c.prototype.getNextNode=function(b,c){var d="next"==b?c.next():c.prev();return d.length||this.index!=this.len-1?d.length||0!=this.index||(d=a(this.$items[this.len-1])):d=a(this.$items[0]),d},a.fn.Slider=b}(jQuery);